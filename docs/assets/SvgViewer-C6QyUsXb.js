import{d as H,r as i,p as O,c as v,a as t,f as C,n as R,z as G,t as U,b as x,v as T,s as B,o as d,_ as P}from"./index-CiOXiSB6.js";const W={class:"svg-viewer-container"},q={class:"tool-wrapper"},J={class:"input-section"},X={class:"form-group"},Q={class:"source-tabs"},K={key:0,class:"upload-area"},Y={key:0},Z={key:1,class:"file-info"},ee={key:1,class:"code-input-area"},te={class:"input-wrapper"},le={key:0,class:"form-group"},ae={class:"export-options"},se={class:"option-group"},oe={class:"radio-group"},ne={class:"radio-label"},ie={class:"radio-label"},re={class:"option-group"},ue={class:"size-slider"},ve=["disabled"],de={class:"option-group"},ce={class:"size-slider"},pe={class:"preview-section"},ge={key:0,class:"svg-preview"},me=["innerHTML"],fe={key:1,class:"placeholder"},be={key:2,class:"action-buttons"},he=H({__name:"SvgViewer",setup(we){const m=i("upload"),u=i(""),f=i(""),_=i(!1),b=i(""),S=i(!1),k=i(null),h=i(null),r=i("png"),w=i(.8),p=i(1),D=()=>{var l;(l=k.value)==null||l.click()},z=l=>{const e=l.target;if(e.files&&e.files.length>0){const a=e.files[0];if(a.type==="image/svg+xml"||a.name.endsWith(".svg")){b.value=a.name;const o=new FileReader;o.onload=s=>{var n;(n=s.target)!=null&&n.result&&(u.value=s.target.result,_.value=!0)},o.readAsText(a)}else alert("请上传 SVG 格式的文件")}},M=l=>{var e;if(S.value=!1,(e=l.dataTransfer)!=null&&e.files&&l.dataTransfer.files.length>0){const a=l.dataTransfer.files[0];if(a.type==="image/svg+xml"||a.name.endsWith(".svg")){b.value=a.name;const o=new FileReader;o.onload=s=>{var n;(n=s.target)!=null&&n.result&&(u.value=s.target.result,_.value=!0)},o.readAsText(a)}else alert("请上传 SVG 格式的文件")}},E=()=>{u.value="",b.value="",k.value&&(k.value.value=""),_.value=!1},F=()=>{if(!f.value){alert("请输入 SVG 代码");return}try{if(!f.value.includes("<svg")&&!f.value.includes("<?xml")){alert("请输入有效的 SVG 代码");return}u.value=f.value,_.value=!0,b.value="svg-from-code.svg"}catch(l){console.error("加载 SVG 代码失败:",l),alert("加载 SVG 代码失败，请检查代码格式是否正确")}},A=()=>{if(!h.value)return;const l=h.value.querySelector("svg");if(!l){alert("未找到有效的 SVG 元素");return}const e=l.cloneNode(!0),a=l.width.baseVal.value||parseInt(l.getAttribute("width")||"0",10)||l.viewBox.baseVal.width,o=l.height.baseVal.value||parseInt(l.getAttribute("height")||"0",10)||l.viewBox.baseVal.height;if(!a||!o){alert("无法确定 SVG 尺寸");return}const s=document.createElement("canvas");s.width=a*p.value,s.height=o*p.value;const n=s.getContext("2d");if(!n){alert("无法创建 Canvas 上下文");return}const L=new XMLSerializer().serializeToString(e),I=new Blob([L],{type:"image/svg+xml;charset=utf-8"}),V=URL.createObjectURL(I),g=new Image;g.onload=()=>{n.drawImage(g,0,0,s.width,s.height),URL.revokeObjectURL(V);let c;r.value==="jpeg"?c=s.toDataURL("image/jpeg",w.value):c=s.toDataURL("image/png");const y=document.createElement("a");y.download=`${b.value.replace(".svg","")}.${r.value}`,y.href=c,y.click()},g.src=V},N=async()=>{if(!h.value)return;const l=h.value.querySelector("svg");if(!l){alert("未找到有效的 SVG 元素");return}const e=l.cloneNode(!0),a=l.width.baseVal.value||parseInt(l.getAttribute("width")||"0",10)||l.viewBox.baseVal.width,o=l.height.baseVal.value||parseInt(l.getAttribute("height")||"0",10)||l.viewBox.baseVal.height;if(!a||!o){alert("无法确定 SVG 尺寸");return}const s=document.createElement("canvas");s.width=a*p.value,s.height=o*p.value;const n=s.getContext("2d");if(!n){alert("无法创建 Canvas 上下文");return}const L=new XMLSerializer().serializeToString(e),I=new Blob([L],{type:"image/svg+xml;charset=utf-8"}),V=URL.createObjectURL(I),g=new Image;g.onload=async()=>{n.drawImage(g,0,0,s.width,s.height),URL.revokeObjectURL(V);try{const c=r.value==="jpeg"?"image/jpeg":"image/png",y=await new Promise($=>{s.toBlob(j=>{j&&$(j)},c,r.value==="jpeg"?w.value:void 0)});await navigator.clipboard.write([new ClipboardItem({[c]:y})]),alert("图片已复制到剪贴板")}catch(c){console.error("复制到剪贴板失败:",c),alert("复制到剪贴板失败，请尝试下载图片")}},g.src=V};return O(()=>{}),(l,e)=>(d(),v("div",W,[e[18]||(e[18]=t("h1",null,"SVG 展示与转换工具",-1)),t("div",q,[t("div",J,[t("div",X,[e[10]||(e[10]=t("label",null,"SVG 来源",-1)),t("div",Q,[t("button",{class:R(["tab-button",{active:m.value==="upload"}]),onClick:e[0]||(e[0]=a=>m.value="upload")}," 上传文件 ",2),t("button",{class:R(["tab-button",{active:m.value==="code"}]),onClick:e[1]||(e[1]=a=>m.value="code")}," SVG 代码 ",2)]),m.value==="upload"?(d(),v("div",K,[t("input",{type:"file",id:"svg-file",accept:".svg,image/svg+xml",onChange:z,ref_key:"fileInput",ref:k,style:{display:"none"}},null,544),t("div",{class:R(["drop-zone",{dragover:S.value}]),onClick:D,onDragover:e[2]||(e[2]=G(a=>S.value=!0,["prevent"])),onDragleave:e[3]||(e[3]=G(a=>S.value=!1,["prevent"])),onDrop:G(M,["prevent"])},[u.value?(d(),v("div",Z,[t("p",null,U(b.value),1),t("button",{class:"small-button",onClick:G(E,["stop"])},"清除")])):(d(),v("div",Y,e[9]||(e[9]=[t("div",{class:"upload-icon"},"📁",-1),t("p",null,"点击或拖拽 SVG 文件到此处",-1)])))],34)])):C("",!0),m.value==="code"?(d(),v("div",ee,[t("div",te,[x(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=a=>f.value=a),placeholder:"粘贴 SVG 代码",class:"text-input code-input"},null,512),[[T,f.value]]),t("button",{class:"action-button",onClick:F},"加载")])])):C("",!0)]),u.value?(d(),v("div",le,[e[16]||(e[16]=t("label",null,"导出设置",-1)),t("div",ae,[t("div",se,[e[13]||(e[13]=t("label",null,"导出格式",-1)),t("div",oe,[t("label",ne,[x(t("input",{type:"radio","onUpdate:modelValue":e[5]||(e[5]=a=>r.value=a),value:"png"},null,512),[[B,r.value]]),e[11]||(e[11]=t("span",null,"PNG",-1))]),t("label",ie,[x(t("input",{type:"radio","onUpdate:modelValue":e[6]||(e[6]=a=>r.value=a),value:"jpeg"},null,512),[[B,r.value]]),e[12]||(e[12]=t("span",null,"JPEG",-1))])])]),t("div",re,[e[14]||(e[14]=t("label",null,"图片质量 (仅 JPEG)",-1)),t("div",ue,[x(t("input",{type:"range","onUpdate:modelValue":e[7]||(e[7]=a=>w.value=a),min:"0.1",max:"1.0",step:"0.1",disabled:r.value!=="jpeg"},null,8,ve),[[T,w.value]]),t("span",null,U(Math.round(w.value*100))+"%",1)])]),t("div",de,[e[15]||(e[15]=t("label",null,"缩放比例",-1)),t("div",ce,[x(t("input",{type:"range","onUpdate:modelValue":e[8]||(e[8]=a=>p.value=a),min:"0.5",max:"3",step:"0.1"},null,512),[[T,p.value]]),t("span",null,U(p.value)+"x",1)])])])])):C("",!0)]),t("div",pe,[u.value?(d(),v("div",ge,[t("div",{class:"svg-container",ref_key:"svgContainer",ref:h,innerHTML:u.value},null,8,me)])):(d(),v("div",fe,e[17]||(e[17]=[t("p",null,"SVG 预览区域",-1),t("p",{class:"sub-text"},"上传 SVG 文件或输入 URL 地址后在此处显示",-1)]))),u.value?(d(),v("div",be,[t("button",{onClick:A,class:"action-button"},"导出为 "+U(r.value.toUpperCase()),1),t("button",{onClick:N,class:"action-button"},"复制到剪贴板")])):C("",!0)])])]))}}),ye=P(he,[["__scopeId","data-v-7a9ea004"]]);export{ye as default};
